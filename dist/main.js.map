{"version":3,"sources":["../main.js"],"names":["main","canvas","document","getElementById","ctx","getContext","dataStore","getInstance","director","loader","resourceLoader","create","onLoaded","onResourceFirstLoaded","map","res","init","isGameOver","put","background","land","birds","registerEvent","createPencil","run","addEventListener","e","preventDefault","birdsEvent"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;IAEaA,I,WAAAA,I;AACT,oBAAc;AAAA;;AAAA;;AACV,aAAKC,MAAL,GAAcC,SAASC,cAAT,CAAwB,aAAxB,CAAd;AACA,aAAKC,GAAL,GAAW,KAAKH,MAAL,CAAYI,UAAZ,CAAuB,IAAvB,CAAX;AACA,aAAKC,SAAL,GAAiBA,qBAAUC,WAAV,EAAjB;AACA,aAAKC,QAAL,GAAgBA,mBAASD,WAAT,EAAhB;AACA,YAAME,SAASC,+BAAeC,MAAf,EAAf;AACAF,eAAOG,QAAP,CAAgB;AAAA,mBAAO,MAAKC,qBAAL,CAA2BC,GAA3B,CAAP;AAAA,SAAhB;AACH;;;;8CAEqBA,G,EAAK;AACvB,iBAAKR,SAAL,CAAeF,GAAf,GAAqB,KAAKA,GAA1B;AACA,iBAAKE,SAAL,CAAeS,GAAf,GAAqBD,GAArB;AACA,iBAAKE,IAAL;AACH;;;+BAEM;;AAEH,iBAAKR,QAAL,CAAcS,UAAd,GAA2B,KAA3B;AACA,iBAAKX,SAAL,CACKY,GADL,CACS,SADT,EACoB,EADpB,EAEKA,GAFL,CAES,YAFT,EAEuBC,sBAFvB,EAGKD,GAHL,CAGS,MAHT,EAGiBE,UAHjB,EAIKF,GAJL,CAIS,OAJT,EAIkBG,YAJlB;AAKA,iBAAKC,aAAL;AACA;AACA,iBAAKd,QAAL,CAAce,YAAd;AACA,iBAAKf,QAAL,CAAcgB,GAAd;AACH;;;wCAEe;AAAA;;AACZ,iBAAKvB,MAAL,CAAYwB,gBAAZ,CAA6B,YAA7B,EAA2C,aAAK;AAC5CC,kBAAEC,cAAF;AACA;AACA,oBAAI,OAAKnB,QAAL,CAAcS,UAAlB,EAA8B;AAC1B,2BAAKD,IAAL;AACH,iBAFD,MAEO;AACH,2BAAKR,QAAL,CAAcoB,UAAd;AACH;AACJ,aARD;AASH","file":"main.js","sourcesContent":["import {resourceLoader} from \"./js/base/resourceLoader.js\";\r\nimport {background} from \"./js/runtime/background.js\";\r\nimport {dataStore} from \"./js/base/dataStore.js\";\r\nimport {director} from \"./js/director.js\";\r\nimport {land} from \"./js/runtime/land.js\";\r\nimport {birds} from \"./js/player/birds.js\";\r\n\r\nexport class main {\r\n    constructor() {\r\n        this.canvas = document.getElementById('game_canvas');\r\n        this.ctx = this.canvas.getContext('2d');\r\n        this.dataStore = dataStore.getInstance();\r\n        this.director = director.getInstance();\r\n        const loader = resourceLoader.create();\r\n        loader.onLoaded(map => this.onResourceFirstLoaded(map));\r\n    }\r\n\r\n    onResourceFirstLoaded(map) {\r\n        this.dataStore.ctx = this.ctx;\r\n        this.dataStore.res = map;\r\n        this.init()\r\n    }\r\n\r\n    init() {\r\n\r\n        this.director.isGameOver = false;\r\n        this.dataStore\r\n            .put('pencils', [])\r\n            .put('background', background)\r\n            .put('land', land)\r\n            .put('birds', birds);\r\n        this.registerEvent();\r\n        // 在游戏逻辑运行之前创建铅笔\r\n        this.director.createPencil();\r\n        this.director.run();\r\n    }\r\n\r\n    registerEvent() {\r\n        this.canvas.addEventListener('touchstart', e => {\r\n            e.preventDefault();\r\n            // 用箭头函数才能将指针指向main，才能取到main中的变量\r\n            if (this.director.isGameOver) {\r\n                this.init();\r\n            } else {\r\n                this.director.birdsEvent();\r\n            }\r\n        });\r\n    }\r\n}"]}